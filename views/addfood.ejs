<!doctype html>
<html>
  <head>
    <a href="/">Home</a>
    <a href="about">About </a>
    <a href="search">Search items</a>
    <a href="additems">Add A items</a>
    <a href="listall">List itemss</a>
    <a href="register">Register</a>
    <a href="login">Login Page</a>
    <a href="logout">Log Out</a>
    <a href="api">items API</a>
    <title>Add itemss to <%=shopName%></title>
    <link rel="stylesheet"  type="text/css" href="main.css" />
  </head>
  <body>
    <h1><%=shopName%>: Add items</h1>
    <video id="video"></video>
    <form method="POST" action="/itemsadded">
      <p>items Name: <input id="name" type="text" name="name" value="" /></p>
      <p>Typical Values Per: <input id="quantity" type="text" name="quantity" value="" /></p>
      <p>Price of Measurement: <input id="price" type="text" name="price" value="" /></p>
      <p>Barcode ID: <input id="barcodeid" type="text" name="barcodeid" value="" /></p>
      <button id="scanButton">Scan Barcode</button>
      <input type="submit" value="Add items" />
    </form>

    <script src="https://unpkg.com/@zxing/library@0.22.0"></script>

    <script>
      // Get the video element and set the constraints for the media stream
      const video = document.getElementById('video');
      const constraints = {
        audio: false,
        video: {
          facingMode: 'environment'
        }
      };

      // Request access to the camera and attach the stream to the video element
      navigator.mediaDevices.getUserMedia(constraints)
        .then(function(stream) {
          video.srcObject = stream;
          video.play();
        })
        .catch(function(error) {
          console.error('Could not access camera', error);
        });

      // Create a barcode scanner instance
      const codeReader = new ZXing.BrowserBarco
      eReader();

      // Attach an event listener to the Scan Barcode button
      const scanButton = document.getElementById('scanButton');
      scanButton.addEventListener('click', async () => {
        try {
          // Use the barcode scanner to scan the barcode and populate the input field
          const result = await codeReader.decodeOnceFromVideoDevice(undefined, 'video');
          document.getElementById('barcodeid').value = result.text;
        } catch (error) {
          console.error(error);
        }
      });
    </script>
  </body>
</html>